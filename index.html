<!DOCTYPE html>
<html lang="en">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0P4RQJL9WS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){ dataLayer.push(arguments); }
  gtag('js', new Date());
  gtag('config', 'G-0P4RQJL9WS');
</script>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Butterfly Dodge</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css?v=2.0.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
</head>
<body>
  <!-- Parallax sky background -->
  <div id="sky" aria-hidden="true">
    <div class="cloud cloud-chicken" style="top:12%; left:-20%; animation-duration: 60s;"></div>
    <div class="cloud cloud-dino"    style="top:28%; left:-40%; animation-duration: 75s;"></div>
    <div class="cloud cloud-eggplant"style="top:52%; left:-30%; animation-duration: 65s;"></div>
    <div class="cloud cloud-puff"    style="top:72%; left:-50%; animation-duration: 80s;"></div>
  </div>
  <!-- Instructions screen (visible on first load only) -->
  <div id="instructions" role="dialog" aria-modal="true">
    <h2>Welcome to Butterfly Dodge</h2>
    <ul class="intro-bullets">
      <li>Avoid 
        <span class="ico" aria-hidden="true">
          <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <!-- Hoop -->
            <circle cx="62" cy="38" r="24" fill="none" stroke="red" stroke-width="8"/>
            <!-- Mesh inside the hoop (simple grid clipped to circle) -->
            <defs>
              <clipPath id="introNetClip"><circle cx="62" cy="38" r="24"/></clipPath>
            </defs>
            <g clip-path="url(#introNetClip)" stroke="red" stroke-width="3" opacity="0.9">
              <path d="M38 22 H86 M38 30 H86 M38 38 H86 M38 46 H86 M38 54 H86"/>
              <path d="M46 14 V62 M54 14 V62 M62 14 V62 M70 14 V62 M78 14 V62"/>
            </g>
            <!-- Handle -->
            <path d="M24 84 L55 55" stroke="red" stroke-width="10" stroke-linecap="round"/>
          </svg>
        </span>
        or lose one life
      </li>
      <li>Drink nectar from 
        <span class="ico" role="img" aria-label="flower">üå∏</span>
        to get one point per flower
      </li>
      <li>10 points adds one life</li>
      <li>0 lives = game over</li>
    </ul>

    <p><strong>Training option</strong>: Press <strong>Shift + Enter</strong> to start a Learn‚Äëto‚ÄëFly session (no nets, same gravity) to practice controls.</p>

    <p><strong>Leveling up</strong>: When Lives reaches 5, you go up a level and Lives reset to 3.</p>
    <p><strong>Tip</strong>: For best results, set browser zoom to 100%.</p>

    <p><strong>Butterfly control ‚Äî use keyboard</strong></p>
    <ul class="intro-bullets">
      <li>Press Left Arrow = slow down</li>
      <li>Press Right Arrow = speed up</li>
      <li>Press Spacebar = flap wings to fly up</li>
      <li>Release Spacebar = butterfly descends</li>
    </ul>

    <p>Touch as many flowers on each pass of the screen from left to right as possible to increase your <strong>Skill</strong> score (average flowers touched per pass).</p>
    <p class="mobile-hint"><em>On mobile: rotate to landscape and tap to start</em></p>
    <p class="mobile-hint"><button id="mobile-start" aria-label="Tap to start the game">Tap to Start</button></p>
    <p class="desktop-hint"><em>On desktop: Press Enter to begin‚Ä¶</em></p>
  </div>

  <!-- Game UI (hidden until game starts) -->
  <div id="game-area" hidden>
    <!-- Rotate-to-landscape gate for mobile -->
    <div id="rotate-overlay" hidden>
      <div class="levelup-wrap">
        <h2>Rotate Your Phone</h2>
        <p>Please rotate your phone to landscape to play.</p>
        <p style="font-size:0.9em; opacity:0.8;">If rotation is locked, unlock it in Control Center/Quick Settings.</p>
      </div>
    </div>
    <!-- Tap-to-start overlay for mobile -->
    <div id="tap-start" hidden>
      <div class="levelup-wrap">
        <h2>Tap to Start</h2>
        <p>Tap anywhere to begin. Tap and hold to flap.</p>
        <p>Swipe right to speed up. Swipe left to slow down.</p>
      </div>
    </div>
    <!-- Training mode banner -->
    <div id="training-banner" hidden>
      <div class="levelup-wrap">
        <h2>Training Mode</h2>
        <p>You are in a special training mode. Nets are disabled so you can practice flying.</p>
        <p>Press <strong>Enter</strong> to start the real game.</p>
      </div>
    </div>
    <!-- Left control rail removed -->
    <div id="hud">
      <span id="score">Points: 0</span>   <span id="lives">Lives: 3</span>   <span id="level">Level: 1</span>   <span>   Mute sound:</span> <button id="mute-sfx" aria-label="Toggle sound effects" title="Toggle sound effects" tabindex="-1">üîä</button>   <span>   Music volume:</span> <input id="music-volume" type="range" min="0" max="100" value="30" />   <span id="skill">Skill: 0.000</span>
    </div>
    <!-- First-flower tutorial overlay -->
    <div id="flowermsg" hidden>
      <div class="levelup-wrap">
        <h2>Nice!</h2>
        <p>Congratulations! Your butterfly just drank some nectar from a flower.</p>
        <p>You get 1 point. 10 points = 1 extra life. 5 lives = jump up a level.</p>
        <p class="desktop-only">Press Enter to continue‚Ä¶</p>
        <p class="mobile-only">Tap to continue‚Ä¶</p>
      </div>
    </div>
    <!-- Skill score tutorial overlay (level 4+ only) -->
    <div id="skillmsg" hidden>
      <div class="levelup-wrap">
        <h2>Skill Score Explained!</h2>
        <p>See the <strong>Skill</strong> score at the top? That's the average number of flowers you're touching per pass from left to right across the screen.</p>
        <p>If this ever reaches <strong>8.000 or higher</strong>, you'll get a powerful surprise! ü¶ã‚ú®</p>
        <p class="desktop-only">Press Enter to continue‚Ä¶</p>
        <p class="mobile-only">Tap to continue‚Ä¶</p>
      </div>
    </div>
    <!-- Super timer badge (shown only during super mode) -->
    <div id="super-timer" hidden>15</div>
    <!-- Level-up announcement overlay -->
    <div id="levelup" hidden>
      <div class="levelup-wrap">
        <h2>Level Up!</h2>
        <p>You reached Level <span id="levelup-num">2</span>.</p>
        <p id="levelup-details">Clouds now bump you to a random spot. Watch out!</p>
        <p class="desktop-only">Press Enter to continue‚Ä¶</p>
        <p class="mobile-only">Tap to continue‚Ä¶</p>
      </div>
    </div>
    <!-- Super Butterfly announcement overlay -->
    <div id="supermsg" hidden>
      <div class="levelup-wrap">
        <h2>Super Butterfly!</h2>
        <p id="supermsg-text">Congrats! You're now a super butterfly for the next 15 seconds.</p>
        <p>While super, touching a flower slides it left to the edge and your pass restarts.</p>
        <p class="desktop-only">Press Enter to continue‚Ä¶</p>
        <p class="mobile-only">Tap to continue‚Ä¶</p>
      </div>
    </div>
    <!-- First-net tutorial overlay -->
    <div id="netmsg" hidden>
      <div class="levelup-wrap">
        <h2>Oh no!</h2>
        <p>Your butterfly just got caught in a net.</p>
        <p>You lose 1 life. Out of lives = game over. 5 lives = jump up to a new level and start with 3 lives.</p>
        <p class="desktop-only">Press Enter to continue‚Ä¶</p>
        <p class="mobile-only">Tap to continue‚Ä¶</p>
      </div>
    </div>
    <div id="game-over" hidden>
      <p>Game Over!</p>
      <p class="desktop-only">Play again? (Y/N)</p>
      <p class="mobile-only">Tap to play again</p>
      <div id="leaderboard" aria-live="polite"></div>
    </div>
    <div id="pause-message" hidden>Game Paused ‚Äî Press any key to resume</div>
    <!-- Mobile pause/play button (shows on touch devices) -->
    <button id="pause-btn" hidden aria-label="Pause game">‚è∏Ô∏è</button>
    <div id="butterfly">
      <svg viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg" class="butterfly-svg">
        <!-- Swallowtail Butterfly - Based on Photo -->
        
        <!-- Upper wings (forewings) -->
        <g class="upper-wings">
          <!-- Left upper wing -->
          <path d="M60 25 Q35 20 25 30 Q15 40 25 50 Q35 45 60 40 Q65 35 60 30 Q60 25 60 25 Z" 
                fill="#FFD700" stroke="#000000" stroke-width="1"/>
          <!-- Black veins on left wing -->
          <path d="M60 25 Q50 30 45 35" stroke="#000000" stroke-width="1.5" fill="none"/>
          <path d="M60 25 Q55 35 50 40" stroke="#000000" stroke-width="1.5" fill="none"/>
          <path d="M25 30 Q40 35 50 40" stroke="#000000" stroke-width="1.5" fill="none"/>
          
          <!-- Right upper wing -->
          <path d="M60 25 Q85 20 95 30 Q105 40 95 50 Q85 45 60 40 Q55 35 60 30 Q60 25 60 25 Z" 
                fill="#FFD700" stroke="#000000" stroke-width="1"/>
          <!-- Black veins on right wing -->
          <path d="M60 25 Q70 30 75 35" stroke="#000000" stroke-width="1.5" fill="none"/>
          <path d="M60 25 Q65 35 70 40" stroke="#000000" stroke-width="1.5" fill="none"/>
          <path d="M95 30 Q80 35 70 40" stroke="#000000" stroke-width="1.5" fill="none"/>
        </g>
        
        <!-- Lower wings (hindwings) -->
        <g class="lower-wings">
          <!-- Left lower wing -->
          <path d="M60 40 Q30 45 20 60 Q25 80 40 75 Q50 70 60 65 Q65 60 60 55 Q60 50 60 40 Z" 
                fill="#FFD700" stroke="#000000" stroke-width="1"/>
          <!-- Blue patches on left hindwing -->
          <circle cx="35" cy="65" r="8" fill="#4169E1" opacity="0.8"/>
          <!-- Orange eyespot on left hindwing -->
          <circle cx="30" cy="70" r="4" fill="#FF8C00" opacity="0.9"/>
          <circle cx="30" cy="70" r="2" fill="#000000"/>
          
          <!-- Right lower wing -->
          <path d="M60 40 Q90 45 100 60 Q95 80 80 75 Q70 70 60 65 Q55 60 60 55 Q60 50 60 40 Z" 
                fill="#FFD700" stroke="#000000" stroke-width="1"/>
          <!-- Blue patches on right hindwing -->
          <circle cx="85" cy="65" r="8" fill="#4169E1" opacity="0.8"/>
          <!-- Orange eyespot on right hindwing -->
          <circle cx="90" cy="70" r="4" fill="#FF8C00" opacity="0.9"/>
          <circle cx="90" cy="70" r="2" fill="#000000"/>
        </g>
        
        <!-- Swallowtail extensions (tails) -->
        <g class="swallowtails">
          <path d="M20 60 Q10 55 5 65 Q10 75 15 70 Q20 65 20 60 Z" 
                fill="#000000" stroke="#000000" stroke-width="1"/>
          <path d="M100 60 Q110 55 115 65 Q110 75 105 70 Q100 65 100 60 Z" 
                fill="#000000" stroke="#000000" stroke-width="1"/>
        </g>
        
        <!-- Body -->
        <ellipse cx="60" cy="50" rx="3" ry="20" fill="#2F2F2F" stroke="#000000" stroke-width="1"/>
        
        <!-- Antennae -->
        <path d="M58 30 Q55 25 52 28" stroke="#2F2F2F" stroke-width="2" fill="none"/>
        <path d="M62 30 Q65 25 68 28" stroke="#2F2F2F" stroke-width="2" fill="none"/>
        <circle cx="52" cy="28" r="2" fill="#2F2F2F"/>
        <circle cx="68" cy="28" r="2" fill="#2F2F2F"/>
        
        <!-- Additional wing details -->
        <g class="wing-details">
          <!-- Yellow spots on wing edges -->
          <circle cx="30" cy="35" r="2" fill="#FFD700"/>
          <circle cx="90" cy="35" r="2" fill="#FFD700"/>
          <circle cx="25" cy="45" r="1.5" fill="#FFD700"/>
          <circle cx="95" cy="45" r="1.5" fill="#FFD700"/>
        </g>
      </svg>
    </div>
    <!-- Mobile pause button -->
    <button id="pause-btn" class="mobile-only" aria-label="Pause game" hidden>‚è∏Ô∏è</button>
  </div>

  <script src="script.js?v=desktopPauseFix1"></script>
</body>
</html>